/*C4*/SET SCHEMA PUBLIC
DISCONNECT
/*C5*/SET SCHEMA PUBLIC
DROP TABLE user_roles IF EXISTS
DROP TABLE meals IF EXISTS
DROP TABLE users IF EXISTS
DROP SEQUENCE global_seq IF EXISTS
CREATE SEQUENCE GLOBAL_SEQ AS INTEGER START WITH 100000
CREATE TABLE users\u000a(\u000a  id               INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,\u000a  name             VARCHAR(255)            NOT NULL,\u000a  email            VARCHAR(255)            NOT NULL,\u000a  password         VARCHAR(255)            NOT NULL,\u000a  registered       TIMESTAMP DEFAULT now() NOT NULL,\u000a  enabled          BOOLEAN DEFAULT TRUE    NOT NULL,\u000a  calories_per_day INTEGER DEFAULT 2000    NOT NULL\u000a)
CREATE UNIQUE INDEX users_unique_email_idx\u000a  ON USERS (email)
CREATE TABLE user_roles\u000a(\u000a  user_id INTEGER NOT NULL,\u000a  role    VARCHAR(255),\u000a  CONSTRAINT user_roles_idx UNIQUE (user_id, role),\u000a  FOREIGN KEY (user_id) REFERENCES USERS (id) ON DELETE CASCADE\u000a)
CREATE TABLE meals\u000a(\u000a  id          INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,\u000a  date_time   TIMESTAMP    NOT NULL,\u000a  description VARCHAR(255) NOT NULL,\u000a  calories    INT          NOT NULL,\u000a  user_id     INTEGER      NOT NULL,\u000a  FOREIGN KEY (user_id) REFERENCES USERS (id) ON DELETE CASCADE\u000a)
CREATE UNIQUE INDEX meals_unique_user_datetime_idx\u000a  ON meals (user_id, date_time)
DISCONNECT
/*C6*/SET SCHEMA PUBLIC
DISCONNECT
/*C7*/SET SCHEMA PUBLIC
ALTER SEQUENCE global_seq RESTART WITH 100000
INSERT INTO USERS VALUES(100000,'User','user@yandex.ru','password','2020-01-25 19:08:27.350000',TRUE,2000)
INSERT INTO USERS VALUES(100001,'Admin','admin@gmail.com','admin','2020-01-25 19:08:27.350000',TRUE,2000)
ALTER SEQUENCE PUBLIC.GLOBAL_SEQ RESTART WITH 100002
COMMIT
INSERT INTO USER_ROLES VALUES(100000,'ROLE_USER')
INSERT INTO USER_ROLES VALUES(100001,'ROLE_ADMIN')
INSERT INTO USER_ROLES VALUES(100001,'ROLE_USER')
COMMIT
INSERT INTO MEALS VALUES(100002,'2015-05-30 10:00:00.000000','\u0417\u0430\u0432\u0442\u0440\u0430\u043a',500,100000)
INSERT INTO MEALS VALUES(100003,'2015-05-30 13:00:00.000000','\u041e\u0431\u0435\u0434',1000,100000)
INSERT INTO MEALS VALUES(100004,'2015-05-30 20:00:00.000000','\u0423\u0436\u0438\u043d',500,100000)
INSERT INTO MEALS VALUES(100005,'2015-05-31 00:00:00.000000','\u0415\u0434\u0430 \u043d\u0430 \u0433\u0440\u0430\u043d\u0438\u0447\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435',100,100000)
INSERT INTO MEALS VALUES(100006,'2015-05-31 10:00:00.000000','\u0417\u0430\u0432\u0442\u0440\u0430\u043a',500,100000)
INSERT INTO MEALS VALUES(100007,'2015-05-31 13:00:00.000000','\u041e\u0431\u0435\u0434',1000,100000)
INSERT INTO MEALS VALUES(100008,'2015-05-31 20:00:00.000000','\u0423\u0436\u0438\u043d',510,100000)
INSERT INTO MEALS VALUES(100009,'2015-06-01 14:00:00.000000','\u0410\u0434\u043c\u0438\u043d \u043b\u0430\u043d\u0447',510,100001)
INSERT INTO MEALS VALUES(100010,'2015-06-01 21:00:00.000000','\u0410\u0434\u043c\u0438\u043d \u0443\u0436\u0438\u043d',1500,100001)
ALTER SEQUENCE PUBLIC.GLOBAL_SEQ RESTART WITH 100011
COMMIT
DISCONNECT
/*C8*/SET SCHEMA PUBLIC
DISCONNECT
